<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
             xmlns:vm="clr-namespace:GoatVaultClient_v3.ViewModels"
             xmlns:models="clr-namespace:GoatVaultClient_v3.Models"
             xmlns:fa="clr-namespace:UraniumUI.Icons.FontAwesome;assembly=UraniumUI.Icons.FontAwesome"
             x:Class="GoatVaultClient_v3.MainPage">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="60"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <BoxView Grid.Row="0" Grid.Column="0" Grid.RowSpan="3" Color="#D6ECFF"/>
        <BoxView Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Color="#D6ECFF"/>
        <BoxView Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Color="#F5F5F5"/>

        <material:ButtonView WidthRequest="55" HeightRequest="55" BackgroundColor="LightSkyBlue">
            <material:ButtonView.StrokeShape>
                <RoundRectangle CornerRadius="40"/>
            </material:ButtonView.StrokeShape>
            <Image>
                <Image.Source>
                    <FontImageSource FontFamily="FASolid" Glyph="{x:Static fa:Solid.User}" Color="White" Size="24"/>
                </Image.Source>
            </Image>
        </material:ButtonView>

        <Label Grid.Row="1" Grid.Column="0" Text="Goat Vault" FontSize="14" HorizontalOptions="Center" Margin="0,5,0,10"/>

        <Grid Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2">
            <Grid HorizontalOptions="Start" VerticalOptions="Center" ColumnSpacing="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <material:TextField Grid.Column="0" Title="Search..." WidthRequest="500" HeightRequest="60" Margin="20,0,0,0"/>

                <material:ButtonView Grid.Column="1" WidthRequest="40" HeightRequest="40" BackgroundColor="SkyBlue">
                    <material:ButtonView.StrokeShape>
                        <RoundRectangle CornerRadius="20"/>
                    </material:ButtonView.StrokeShape>
                    <Image>
                        <Image.Source>
                            <FontImageSource FontFamily="FASolid" Glyph="{x:Static fa:Solid.Filter}" Color="White" Size="20"/>
                        </Image.Source>
                    </Image>
                </material:ButtonView>
            </Grid>
        </Grid>

        <VerticalStackLayout Grid.Row="2" Grid.Column="0" Spacing="25" Padding="0" HorizontalOptions="Center" Margin="0,50,0,0">
            <material:ButtonView WidthRequest="55" HeightRequest="55" BackgroundColor="SkyBlue">
                <material:ButtonView.StrokeShape>
                    <RoundRectangle CornerRadius="27"/>
                </material:ButtonView.StrokeShape>
                <Image>
                    <Image.Source>
                        <FontImageSource FontFamily="FASolid" Glyph="{x:Static fa:Solid.Book}" Color="White" Size="24"/>
                    </Image.Source>
                </Image>
            </material:ButtonView>

            <material:ButtonView WidthRequest="55" HeightRequest="55" BackgroundColor="SkyBlue">
                <material:ButtonView.StrokeShape>
                    <RoundRectangle CornerRadius="27"/>
                </material:ButtonView.StrokeShape>
                <Image>
                    <Image.Source>
                        <FontImageSource FontFamily="FASolid" Glyph="{x:Static fa:Solid.HatWizard}" Color="White" Size="24"/>
                    </Image.Source>
                </Image>
            </material:ButtonView>

            <material:ButtonView WidthRequest="55" HeightRequest="55" BackgroundColor="SkyBlue">
                <material:ButtonView.StrokeShape>
                    <RoundRectangle CornerRadius="27"/>
                </material:ButtonView.StrokeShape>
                <Image>
                    <Image.Source>
                        <FontImageSource FontFamily="FASolid" Glyph="{x:Static fa:Solid.Gear}" Color="White" Size="24"/>
                    </Image.Source>
                </Image>
            </material:ButtonView>
        </VerticalStackLayout>

        <Grid RowDefinitions="Auto,*,Auto" Grid.Row="1" Grid.Column="1" Grid.RowSpan="2" BackgroundColor="#f5f5f5" Padding="10">

            <Grid Grid.Row="0" ColumnDefinitions="*, Auto" Padding="10,5" BackgroundColor="{AppThemeBinding Light=#f0f0f0, Dark=#1e1e1e}">
                <VerticalStackLayout Grid.Column="0" VerticalOptions="Center">
                    <Label Text="Current Location" FontSize="10" TextColor="Gray"/>
                    <Label Text="{Binding CurrentContextName}" FontSize="16" FontAttributes="Bold" TextColor="{AppThemeBinding Light=Black, Dark=White}"/>
                </VerticalStackLayout>

                <material:ButtonView Grid.Column="1" WidthRequest="32" HeightRequest="32" BackgroundColor="SkyBlue" PressedCommand="{Binding SortFoldersCommand}">
                    <material:ButtonView.StrokeShape>
                        <RoundRectangle CornerRadius="16"/>
                    </material:ButtonView.StrokeShape>
                    <Image>
                        <Image.Source>
                            <FontImageSource FontFamily="FASolid" Glyph="{x:Static fa:Solid.SortDown}" Color="White" Size="24"/>
                        </Image.Source>
                    </Image>
                </material:ButtonView>
            </Grid>

            <CollectionView Grid.Row="1" ItemsSource="{Binding Categories}" SelectionMode="Single" EmptyView="No folders found.">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="x:String">
                        <Grid Padding="0,2">
                            <Border StrokeThickness="0" StrokeShape="RoundRectangle 5" BackgroundColor="{AppThemeBinding Light=White, Dark=#2d2d2d}" Padding="8,4">
                                <Grid ColumnDefinitions="30, *">
                                    <Image Grid.Column="0" HeightRequest="20" WidthRequest="20" HorizontalOptions="Center" VerticalOptions="Center" Aspect="AspectFit">
                                        <Image.Source>
                                            <FontImageSource Glyph="Folder" FontFamily="FASolid" Color="{AppThemeBinding Light=#skyblue, Dark=#bb86fc}" Size="16"/>
                                        </Image.Source>
                                    </Image>
                                    <Label Grid.Column="1" Text="{Binding .}" FontSize="13" VerticalOptions="Center" TextColor="{AppThemeBinding Light=Black, Dark=White}"/>
                                </Grid>
                            </Border>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <material:ButtonView Grid.Row="1" PressedCommand="{Binding CreateFolderCommand}" HorizontalOptions="End" VerticalOptions="End" Margin="20" HeightRequest="50" WidthRequest="50" BackgroundColor="SkyBlue" ZIndex="10">
                <material:ButtonView.Shadow>
                    <Shadow Brush="Black" Offset="2,2" Radius="5" Opacity="0.3"/>
                </material:ButtonView.Shadow>
                <material:ButtonView.StrokeShape>
                    <RoundRectangle CornerRadius="25"/>
                </material:ButtonView.StrokeShape>
                <Label Text="&#x2b;" FontFamily="FaSolid" TextColor="White" FontSize="24" HorizontalOptions="Center" VerticalOptions="Center"/>
            </material:ButtonView>
        </Grid>

        <Grid RowDefinitions="Auto,*,Auto" Grid.Row="1" Grid.Column="2" Grid.RowSpan="2" BackgroundColor="#f5f5f5" Padding="10">

            <Grid Grid.Row="0" ColumnDefinitions="*, Auto" Padding="10,5" BackgroundColor="{AppThemeBinding Light=#f0f0f0, Dark=#1e1e1e}">
                <VerticalStackLayout Grid.Column="0" VerticalOptions="Center">
                    <Label Text="Vault Items" FontSize="10" TextColor="Gray"/>
                    <Label Text="Passwords" FontSize="16" FontAttributes="Bold" TextColor="{AppThemeBinding Light=Black, Dark=White}"/>
                </VerticalStackLayout>

                <material:ButtonView Grid.Column="1" WidthRequest="32" HeightRequest="32" BackgroundColor="SkyBlue" PressedCommand="{Binding SortPasswordsCommand}">
                    <material:ButtonView.StrokeShape>
                        <RoundRectangle CornerRadius="16"/>
                    </material:ButtonView.StrokeShape>
                    <Image>
                        <Image.Source>
                            <FontImageSource FontFamily="FASolid" Glyph="{x:Static fa:Solid.SortDown}" Color="White" Size="24"/>
                        </Image.Source>
                    </Image>
                </material:ButtonView>
            </Grid>

            <CollectionView Grid.Row="1" ItemsSource="{Binding Passwords}" SelectionMode="Single" EmptyView="No items found.">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                </CollectionView.ItemsLayout>

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:PasswordItem">
                        <Grid Padding="0,2">
                            <Border StrokeThickness="0" StrokeShape="RoundRectangle 5" BackgroundColor="{AppThemeBinding Light=White, Dark=#2d2d2d}" Padding="10,8">
                                <Grid ColumnDefinitions="30, 2*, 1.5*, Auto" ColumnSpacing="10" VerticalOptions="Center">

                                    <Image Grid.Column="0" HeightRequest="20" WidthRequest="20" HorizontalOptions="Center" VerticalOptions="Center">
                                        <Image.Source>
                                            <FontImageSource FontFamily="FASolid" Glyph="{Binding Icon}" Color="Gray" Size="18"/>
                                        </Image.Source>
                                    </Image>

                                    <VerticalStackLayout Grid.Column="1" VerticalOptions="Center" Spacing="0">
                                        <Label Text="{Binding Description}" FontAttributes="Bold" FontSize="14" TextColor="{AppThemeBinding Light=Black, Dark=White}" LineBreakMode="TailTruncation"/>
                                        <Label Text="{Binding UserName}" FontSize="11" TextColor="Gray" LineBreakMode="TailTruncation"/>
                                    </VerticalStackLayout>

                                    <Label Grid.Column="2" Text="{Binding MaskedPassword}" VerticalOptions="Center" HorizontalOptions="Start" TextColor="{AppThemeBinding Light=#555, Dark=#aaa}" FontSize="14" FontAttributes="Bold"/>

                                    <material:ButtonView Grid.Column="3" WidthRequest="36" HeightRequest="36" BackgroundColor="SkyBlue" 
                                                         PressedCommand="{Binding Source={RelativeSource AncestorType={x:Type vm:MainPageViewModel}}, Path=CopyPasswordCommand}"
                                                         CommandParameter="{Binding Password}">
                                        <material:ButtonView.StrokeShape>
                                            <RoundRectangle CornerRadius="18"/>
                                        </material:ButtonView.StrokeShape>
                                        <Image VerticalOptions="Center" HorizontalOptions="Center">
                                            <Image.Source>
                                                <FontImageSource FontFamily="FASolid" Glyph="{x:Static fa:Solid.Copy}" Color="White" Size="16"/>
                                            </Image.Source>
                                        </Image>
                                    </material:ButtonView>

                                </Grid>
                            </Border>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <material:ButtonView Grid.Row="1" PressedCommand="{Binding CreatePasswordCommand}" HorizontalOptions="End" VerticalOptions="End" Margin="20" HeightRequest="50" WidthRequest="50" BackgroundColor="SkyBlue" ZIndex="10">
                <material:ButtonView.Shadow>
                    <Shadow Brush="Black" Offset="2,2" Radius="5" Opacity="0.3"/>
                </material:ButtonView.Shadow>
                <material:ButtonView.StrokeShape>
                    <RoundRectangle CornerRadius="25"/>
                </material:ButtonView.StrokeShape>
                <Label Text="&#x2b;" FontFamily="FaSolid" TextColor="White" FontSize="24" HorizontalOptions="Center" VerticalOptions="Center"/>
            </material:ButtonView>
        </Grid>

    </Grid>
</ContentPage>