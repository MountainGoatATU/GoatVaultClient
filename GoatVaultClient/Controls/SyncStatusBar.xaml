<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="GoatVaultClient.Controls.SyncStatusBar"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:controls="clr-namespace:GoatVaultClient.Controls"
    xmlns:m="clr-namespace:UraniumUI.Icons.MaterialSymbols;assembly=UraniumUI.Icons.MaterialSymbols">
    <HorizontalStackLayout HorizontalOptions="End" Spacing="8">

        <!--  Sync Status Indicator  -->
        <HorizontalStackLayout Spacing="{StaticResource sContent}">
            <!--  Animated sync icon when syncing  -->
            <Label
                x:Name="SyncingIcon"
                FontFamily="MaterialRounded"
                FontSize="16"
                IsVisible="{Binding IsSyncing}"
                Text="{x:Static m:MaterialRounded.Sync}"
                TextColor="{AppThemeBinding Light={StaticResource LightPrimary},
                                            Dark={StaticResource DarkPrimary}}"
                VerticalOptions="Center" />

            <!--  Success icon when synced  -->
            <Label
                FontFamily="MaterialRounded"
                FontSize="16"
                IsVisible="{Binding IsSynced}"
                Text="{x:Static m:MaterialRounded.Check_circle}"
                TextColor="{AppThemeBinding Light={StaticResource LightTertiary},
                                            Dark={StaticResource DarkTertiary}}"
                VerticalOptions="Center" />

            <!--  Error icon when sync failed  -->
            <Label
                FontFamily="MaterialRounded"
                FontSize="16"
                IsVisible="{Binding SyncFailed}"
                Text="{x:Static m:MaterialRounded.Error}"
                TextColor="{AppThemeBinding Light={StaticResource LightError},
                                            Dark={StaticResource DarkError}}"
                VerticalOptions="Center" />

            <!--  Status text  -->
            <Label
                FontAttributes="Bold"
                Style="{StaticResource MaterialLabelSmall}"
                Text="{Binding SyncStatusText}"
                VerticalOptions="Center" />
        </HorizontalStackLayout>

        <!--  Last Updated Label  -->
        <Label
            x:Name="LastUpdatedLabel"
            IsVisible="{Binding ShowLastUpdated}"
            Style="{StaticResource MaterialLabelSmall}"
            VerticalOptions="Center">
            <Label.FormattedText>
                <FormattedString>
                    <Span Text="Last synced: " />
                    <Span FontAttributes="Bold" Text="{Binding LastSyncedFormatted}" />
                </FormattedString>
            </Label.FormattedText>
        </Label>

        <!--  Sync Button - appears based on SyncingService state  -->
        <controls:ImageButton
            x:Name="SyncButton"
            ButtonBgColor="{AppThemeBinding Light={StaticResource LightTertiaryContainer},
                                            Dark={StaticResource DarkTertiaryContainer}}"
            Command="{Binding SyncCommand}"
            IconColor="{AppThemeBinding Light={StaticResource LightOnTertiaryContainer},
                                        Dark={StaticResource DarkOnTertiaryContainer}}"
            IconGlyph="{x:Static m:MaterialRounded.Refresh}"
            IsEnabled="{Binding IsSyncButtonEnabled}"
            IsVisible="{Binding ShowSyncButton}"
            VerticalOptions="Center" />

        <!--  Auto-sync indicator  -->
        <Label
            FontFamily="MaterialRounded"
            FontSize="20"
            IsVisible="{Binding IsAutoSyncDisabled}"
            Text="{x:Static m:MaterialRounded.Sync_disabled}"
            TextColor="{AppThemeBinding Light={StaticResource LightOnSurfaceVariant},
                                        Dark={StaticResource DarkOnSurfaceVariant}}"
            ToolTipProperties.Text="Auto-sync is disabled"
            VerticalOptions="Center" />
    </HorizontalStackLayout>
</ContentView>
