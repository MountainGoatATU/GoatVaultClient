<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="GoatVaultClient.Pages.RegisterPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:controls="clr-namespace:GoatVaultClient.Controls"
    xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
    xmlns:vm="clr-namespace:GoatVaultClient.ViewModels"
    x:DataType="vm:RegisterPageViewModel"
    BackgroundColor="{AppThemeBinding Light={StaticResource LightSurface},
                                      Dark={StaticResource DarkSurface}}">


    <controls:Component Padding="{StaticResource pContent}">
        <Grid RowDefinitions="*,Auto,*">
            <VerticalStackLayout
                Grid.Row="1"
                HorizontalOptions="Center"
                Spacing="{StaticResource formSpacing}"
                WidthRequest="{StaticResource textFieldWidth}">
                <Label
                    HorizontalOptions="Center"
                    Style="{x:StaticResource MaterialDisplayMedium}"
                    Text="Register" />
                <material:TextField Title="Email" Text="{Binding Email}" />
                <Label Text="Invalid email"
                       TextColor="Red"
                       FontSize="12"
                       IsVisible="{Binding ShowInvalidEmail}"/>   
                <material:TextField
                    Title="Master Password"
                    IsPassword="True"
                    Text="{Binding Password}">
                    <material:TextField.Attachments>
                        <material:TextFieldPasswordShowHideAttachment />
                    </material:TextField.Attachments>
                </material:TextField>
                <VerticalStackLayout Spacing="4" IsVisible="{Binding ShowPasswordRequirements}">
                    <Label Text="At least 12 characters" TextColor="{Binding IsLengthValid, Converter={StaticResource BoolToColorConverter}}" />
                    <Label Text="Uppercase letter" TextColor="{Binding HasUpperCase, Converter={StaticResource BoolToColorConverter}}" />
                    <Label Text="Lowercase letter" TextColor="{Binding HasLowerCase, Converter={StaticResource BoolToColorConverter}}" />
                    <Label Text="Digit" TextColor="{Binding HasDigit, Converter={StaticResource BoolToColorConverter}}" />
                    <Label Text="Special character" TextColor="{Binding HasSpecialChar, Converter={StaticResource BoolToColorConverter}}" />
                </VerticalStackLayout>
                <material:TextField
                    Title="Confirm Password"
                    IsPassword="True"
                    Text="{Binding ConfirmPassword}">
                    <material:TextField.Attachments>
                        <material:TextFieldPasswordShowHideAttachment />
                    </material:TextField.Attachments>
                </material:TextField>
                <Label
                    Text="Passwords do not match"
                    TextColor="Red"
                    FontSize="12"
                    IsVisible="{Binding ShowPasswordMismatch}" />
                <Button
                    BackgroundColor="{AppThemeBinding Light={x:StaticResource LightPrimaryContainer},
                                                      Dark={x:StaticResource DarkPrimaryContainer}}"
                    Command="{Binding RegisterCommand}"
                    Text="Register"
                    IsEnabled="{Binding AllValid}"
                    TextColor="{AppThemeBinding Light={x:StaticResource LightOnPrimaryContainer},
                                                Dark={x:StaticResource DarkOnPrimaryContainer}}" />
                <HorizontalStackLayout HorizontalOptions="Center" Spacing="0">
                    <Label
                        Text="Already have an account?"
                        TextColor="{AppThemeBinding Light={x:StaticResource LightOnSurfaceVariant},
                                                    Dark={x:StaticResource DarkOnSurfaceVariant}}"
                        VerticalOptions="Center" />
                    <Button
                        BackgroundColor="Transparent"
                        Command="{Binding GoToLoginCommand}"
                        FontSize="{StaticResource tMedium}"
                        Text="Login"
                        TextColor="{AppThemeBinding Light={x:StaticResource LightOnSurface},
                                                    Dark={x:StaticResource DarkOnSurface}}" />
                </HorizontalStackLayout>
                <HorizontalStackLayout HorizontalOptions="Center" Spacing="0">
                    <Label
                        Text="Forgot master password?"
                        TextColor="{AppThemeBinding Light={x:StaticResource LightOnSurfaceVariant},
                                                    Dark={x:StaticResource DarkOnSurfaceVariant}}"
                        VerticalOptions="Center" />
                    <Button
                        BackgroundColor="Transparent"
                        Command="{Binding GoToRecoverCommand}"
                        FontSize="{StaticResource tMedium}"
                        Text="Recover"
                        TextColor="{AppThemeBinding Light={x:StaticResource LightOnSurface},
                                                    Dark={x:StaticResource DarkOnSurface}}" />
                </HorizontalStackLayout>
                <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" />
            </VerticalStackLayout>
        </Grid>
    </controls:Component>
</ContentPage>